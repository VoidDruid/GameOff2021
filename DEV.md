# Заметки по разработке

Сейчас гитом игнорируются аддоны, в папке addons есть `LIST.md`, в котором ссылки на все используемые аддоны. После клонирования репозитория, эти аддоны надо установить.

Все ассеты сейчас хранятся в репозитории, без git lfs или облака. В будущем, если репозиторий разрастется, надо будет вынести ассеты из гита.

---

Ассеты, используемые во многих местах хранятся в `shared`. Все остальные модели, текстуры, звуки, **скрипты** и пр. хранятся "вместе" - в одной папке с объектом, к которому они принадлежат. Например, картинки, используемые только в ui, лежат в `ui`, а не в `shared`, а меши, текстуры и звуки условного объекта "машина" будут лежать в `objects/car`.

Как уже было указано, скрипты относящиеся к конкретному объекту лежат вместе с ним. Скрипты, описывающие общую логику или не относящиеся к объектам лежат в `logic`. GDNative - в `modules`.

Для генерации некоторых скриптов используется m4. Такие скрипты *нельзя импортировать* сами по себе. Для генерации "рабочих" `.gd` файлов выполните `make apply_m4`. Это сгенерирует рядом с каждым `*.gd.m4` файлом соответствующий `*.gd`, который уже можно импоритровать и использовать, но *нельзя изменять* - изменения надо вносить в его "прототип" и генерировать снова. Дефолтные макросы объявлены в `logic/macros.def.m4`.

Для генерации файлов данных в `gamedata` используется jsonnet. Все файлы с расширением jsonnet будут обработаны и резльутат сохранен в `gamedata/objects/*.json`. Для генерации используется команда `make apply_jsonnet`.

Утилитарные скрипты разработчика (баш и пр.) хранятся в `scripts`. Шорткаты для всех скриптов есть в Makefile - **`make help`** для вывода подсказки. Сгенерировать всё - просто `make` или `make apply_all`.
